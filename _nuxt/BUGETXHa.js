import{_ as U}from"./CFTlz3YN.js";import{u as z}from"./CXc6Ek30.js";import{u as G,a as H}from"./B3-n6PZE.js";import{_ as W,m as q,x as w,f as l,e as J,c as u,o as n,k as K,a as o,h as p,t as _,u as i,F as E,i as L,j as f,w as h,p as b,l as Q,b as X,d as x}from"./DOUM3e2N.js";import{A as Y}from"./BDgLvZCc.js";import{c as Z}from"./C90nouMY.js";import{c as m}from"./BcsVgARc.js";const tt={class:"section"},at={class:"container"},et={class:"row justify-content-center"},st={class:"col-sm-10 col-md-8"},ot={class:"mb-5"},nt={class:"col-sm-10 col-md-8"},it={class:"tech-card"},lt={key:0,class:"row justify-content-center mt-5"},rt={class:"col-sm-10 col-md-8"},ct={class:"pagination-nav","aria-label":"標籤文章分頁導覽"},ut={class:"pagination-wrapper"},dt={class:"pagination-numbers"},vt={key:1,class:"pagination-ellipsis"},pt={key:2,class:"pagination-ellipsis"},_t={class:"pagination-info"},g=2,mt={__name:"[[page]]",async setup(gt){var A;let y,P;const D=q(),a=D.params.tag;if(!a)throw w();const k=Z.articleListMaxLimit,t=l(()=>{const e=parseInt(D.params.page)||1;return isNaN(e)||e<1?1:e}),V=l(()=>(t.value-1)*k),{data:F}=([y,P]=J(async()=>G(`articles-by-tag-${a}-page-${t.value}`,async()=>{try{return{postsData:await H().getArticlesWithTag(a,k,V.value),tagName:a}}catch(e){throw w({message:e.message||"Failed to fetch articles"})}})),y=await y,P(),y),$=((A=F.value)==null?void 0:A.postsData)||{items:[],total:0},M=$.items||[],s=l(()=>$.total?Math.ceil($.total/k):1);if(t.value>s.value&&s.value>0)throw w({statusMessage:`標籤 "${a}" 的第 ${t.value} 頁不存在`});const B=l(()=>M.filter(e=>e&&typeof e=="object"&&e.id&&typeof e.id=="string"&&e.id.trim()&&e.title)),C=l(()=>{const e=[],r=Math.max(2,t.value-g),d=Math.min(s.value-1,t.value+g);for(let v=r;v<=d;v++)v!==1&&v!==s.value&&e.push(v);return e}),I=l(()=>t.value>g+1||s.value<=5),R=l(()=>t.value<s.value-g||s.value<=5),S=l(()=>t.value>g+2),T=l(()=>t.value<s.value-g-1),N=l(()=>{const e=t.value>1?` - 第 ${t.value} 頁`:"";return`${a} 相關文章${e} - ${m.title}`}),j=`所有與 ${a} 主題相關的文章`;return z({title:N,meta:[{name:"description",content:j},{property:"og:title",content:N},{property:"og:description",content:j},{property:"og:url",content:`${m.domain}${m.baseUrl}tag/${a}`},{name:"keywords",content:[...m.keywords,`${a} 相關文章`].join(",")}],link:[{rel:"canonical",href:`${m.domain}${m.baseUrl}tag/${a}`}]}),(e,r)=>{const d=U,v=Q("motion");return n(),u("section",tt,[K((n(),u("motion-div",at,[o("div",et,[o("div",st,[o("h1",ot,' Posts tagged with "'+_(i(a))+'" ',1)])]),(n(!0),u(E,null,L(B.value,(c,O)=>(n(),u("div",{key:c.id||O,class:"row justify-content-center mb-4"},[o("div",nt,[o("div",it,[X(i(Y),{post:c,"marked-tag":i(a)},null,8,["post","marked-tag"])])])]))),128)),s.value>1?(n(),u("div",lt,[o("div",rt,[o("nav",ct,[o("div",ut,[t.value>1?(n(),f(d,{key:0,to:t.value===2?`/tag/${i(a)}`:`/tag/${i(a)}/${t.value-1}`,class:"pagination-link pagination-prev","aria-label":"上一頁"},{default:h(()=>r[0]||(r[0]=[o("i",{class:"fas fa-chevron-left"},null,-1),o("span",null,"上一頁",-1)])),_:1,__:[0]},8,["to"])):p("",!0),o("div",dt,[I.value?(n(),f(d,{key:0,to:`/tag/${i(a)}`,class:b(["pagination-number",{active:t.value===1}])},{default:h(()=>r[1]||(r[1]=[x(" 1 ")])),_:1,__:[1]},8,["to","class"])):p("",!0),S.value?(n(),u("span",vt,"...")):p("",!0),(n(!0),u(E,null,L(C.value,c=>(n(),f(d,{key:c,to:c===1?`/tag/${i(a)}`:`/tag/${i(a)}/${c}`,class:b(["pagination-number",{active:t.value===c}])},{default:h(()=>[x(_(c),1)]),_:2},1032,["to","class"]))),128)),T.value?(n(),u("span",pt,"...")):p("",!0),R.value?(n(),f(d,{key:3,to:`/tag/${i(a)}/${s.value}`,class:b(["pagination-number",{active:t.value===s.value}])},{default:h(()=>[x(_(s.value),1)]),_:1},8,["to","class"])):p("",!0)]),t.value<s.value?(n(),f(d,{key:1,to:`/tag/${i(a)}/${t.value+1}`,class:"pagination-link pagination-next","aria-label":"下一頁"},{default:h(()=>r[2]||(r[2]=[o("span",null,"下一頁",-1),o("i",{class:"fas fa-chevron-right"},null,-1)])),_:1,__:[2]},8,["to"])):p("",!0)]),o("div",_t," 第 "+_(t.value)+" 頁，共 "+_(s.value)+" 頁（總計 "+_(i($).total)+' 篇 "'+_(i(a))+'" 相關文章） ',1)])])])):p("",!0)])),[[v,{initial:{opacity:0,x:40},enter:{opacity:1,x:0,transition:{duration:.6}}}]])])}}},xt=W(mt,[["__scopeId","data-v-67504d1d"]]);export{xt as default};
